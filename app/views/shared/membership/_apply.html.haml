.about
  .text.tf
    =pitch_line
-@account ||= current_user.try(:password_account) || PasswordAccount.new(:user => current_user)

-display = "light inlinelabels"
-display << " applying" if current_city.try(:at_capacity?)

=spot_form_for @account, :url => application_path, :display => display, :ul_id => "appformcontainer", :html => {:id => "applicationform"} do |f|
  =hidden_field_tag :invite_code, session_invite.try(:code)
  -if params[:plan]
    =hidden_field_tag :plan, params[:plan]
  -unless current_user.try(:ready_for_membership?)
    .application.clearfix.step
      -if current_city.try(:at_capacity?)
        %h2.tf.capacity We're at capacity. Apply to be notified when space opens up.
      .col.form
        =f.name_fields :required => true, :label => "name : ", :value => @account.try(:user).try(:names) || current_user.try(:names)
        -if logged_in? && current_user.has_account?
          =f.email_field :login, :placeholder => "email address", :required => true, :label => "email : ", :value => current_user.try(:email)
        -else
          =f.email_field :login, :placeholder => "email address", :required => true, :label => "email : ", "data-validate-url" => availability_email_path, "data-invalid-msg" => "looks like you've already registered", :value => invite_request.try(:email)
          =f.password_field :password, :placeholder => "password", :required => true, :minlength => 4, :maxlength => 25, :label => "password : "
        =f.fields_for :user_attributes do |uf|
          =uf.city_select 'city_id', current_city.try(:id), :html => { :required => true, :min => 0 }
        =f.error_messages
        %li.buttons.clearfix
          =button_tag :class => "tf" do
            submit

      .col.descriptions
        =render :partial => "/site/shared/explanations/pricing", :locals => {:cssclass => "first"}
        =render :partial => "/site/shared/explanations/five_reasons", :locals => {:cssclass => "last"}