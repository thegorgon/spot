-mode = (mode || :login).to_sym
-@account ||= PasswordAccount.new
%ul#authenticate.form.faded.fade_in.narrow_center
  :javascript
    document.getElementById('authenticate').style.display = 'none';
  %li.header.clearfix
    %h1 
      Login to
    .image=image_tag("logos/gradient_script_340x270.png", :width => 100, :height => 82)
  %li.section.clearfix.fb
    =form_for :credentials, :url => session_path, :html => { :id => "fbconnect_form" } do |f|
      =f.hidden_field :key, :value => @nonce.digested
      =f.fields_for :facebook do |g|
        =g.hidden_field :access_token, :rel => "access_token"
        =g.hidden_field :facebook_id, :rel => "uid"
      =button_tag :class => "fbconnect" do
        connect
    %h3
      .logo=image_tag("assets/general/fb_f_24x22.png", :size => "24x22")
      Facebook : 
  %li.divider
  %li.section.email
    .radio_fade.clearfix
      .choice.clearfix{:rel => "#login_form", :class => conditionally('selected', mode == :login)}
        .radio.faded
          .indicator
        .label login
      .choice.clearfix{:rel => "#register_form", :class => conditionally('selected', mode == :register)}
        .radio.faded
          .indicator
        .label register
    %h3 Email : 
    .form_container
      =spot_form_for :credentials, :url => session_path, :html => { :class => conditionally('selected', mode == :login), :id => "login_form" } do |f|
        =f.hidden_field :key, :value => @nonce.digested
        =f.fields_for :password do |p|
          =p.email_field :login, :placeholder => "email", "data-validate-url" => existence_email_path, :required => true
          =p.password_field :password, :placeholder => "password", :required => true
        %li.buttons.clearfix
          =button_tag do
            login
          =link_to "forgot password", new_password_reset_path
  
      =spot_form_for @account, :url => account_path, :html => {:id => "register_form", :class => conditionally('selected', mode == :register)} do |f|
        =f.text_field :name, :placeholder => "name", :required => true, :hint => "what should we call you?"
        =f.email_field :login, :placeholder => "email", :required => true, :hint => "how should we reach you?", "data-validate-url" => availability_email_path, "data-invalid-msg" => "looks like you've already registered"
        =f.password_field :password, :placeholder => "password", :required => true, :hint => "4 to 25 characters please", :minlength => 4, :maxlength => 25
        %li.buttons.clearfix
          =button_tag do
            register